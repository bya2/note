# WebRTC Protocols

## ICE (Interactive Connectivity Establishment, 상호 연결 설정) 프레임워크

- `웹 브라우저`가 `피어`들과 연결될 수 있도록 하는 역할
- `STUN` 및 `TURN` 서버를 사용

### 피어A에서 피어B로 곧바로 연결할 수 없는 이유

- `커넥션`을 연결할 수 없도록 하는 방화벽을 우회 필요
- 장치에 공용 IP 주소가 없는 경우 고유 주소를 제공 필요
- 라우터와 피어와의 직접 연결을 허용하지 않는 경우 서버를 통해서 데이터를 릴레이 필요

## STUN (Session Traversal Utilities for NAT, NAT용 세션 순회 유틸리티) 프로토콜

- 사용자의 공용 주소를 검색
- 피어와의 직접 연결을 방해하는 사용자 측의 라우터의 모든 제한(규칙)을 결정

#### 클라이언트의 역할

- 클라이언트는 인터넷을 통해 `STUN` 서버에 요청을 전달

#### STUN 서버의 역할

- 클라이언트의 `공용 주소`로 응답하고, 라우터의 NAT 뒤에 클라이언트가 접근할 수 있는지에 대한 여부를 응답

## NAT (Network Address Translation, 네트워크 주소 변환)

[NAT](./NAT.md)

## TURN (Traversal Using Relays around NAT, NAT을 중심으로 릴레이를 사용한 순회) 서버

NAT을 사용하는 일부 라우터는 `Symmetric NAT`라고 하는 규제를 사용

- 라우터가 이전에 연결된 피어의 연결만 허용한다는 의미

#### `Symmetric NAT 규제`를 우회

1. TURN 서버와의 커넥션을 연결
2. 해당 TURN 서버를 통해 모든 정보를 릴레이

- TURN 서버와의 커넥션을 생성
- 모든 피어에 패킷을 서버로 전송하도록 지시

- 오버헤드를 동반하므로 다른 대안이 없을 시에만 사용

## SDP (Session Description Protocol, 세션 설명 프로토콜)

- 데이터가 전송되면, 두 피어 간에 서로 이해할 수 있도록 해상도, 형식, 코덱, 암호화 등과 같은 커넥션의 멀티미디어 컨텐츠를 설명하는 표준
- 미디어 콘텐츠 자체가 아니라 콘텐츠를 설명하는 `메타데이터`

- 프로토콜이 아니라 장치 간에 미디어를 공유하는 연결을 설명하는 데 사용되는 데이터 형식

- SDP는 한 줄 이상의 `UTF-8` 텍스트로 구성
- 한 글자 유형으로 시작하고, 등호(=)가 뒤따름
- 형식 `문자-줄`

- 미디어 설명을 제공하는 선은 "m"유형을 가지므로, 이러한 선은 `m-lines`이라고 함
